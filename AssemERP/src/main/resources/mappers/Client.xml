<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
"http://mybatis.org/dtd/mybatis-3-mapper.dtd">

<mapper namespace="com.WiseForce.AssemERP.ClientMapper">
	<select id="clientTotCnt" resultType="int">
		SELECT COUNT(*) FROM Client
	</select>
	
	<select id="clientList" parameterType="ClientDto" resultType="ClientDto">
	
		<![CDATA[
		SELECT *
		FROM   (SELECT rownum rn, a.*
				FROM   (SELECT *
						FROM   Client
						ORDER BY client_no
						) a			
				)
		WHERE  rn >= #{start} AND rn <= #{end}	
		 ]]>
		 
	</select>
	
	 <select id="totSearchClient" parameterType="ClientSearchDto" resultType="int">
	 
    SELECT COUNT(*) 
      FROM Client
    <where>
      <if test="client_Name != null and client_Name.trim() != ''">
        AND client_name LIKE '%' || #{client_Name} || '%'
      </if>
      <if test="client_Gubun != null">
        AND client_gubun = #{client_Gubun}
      </if>
      <if test="client_Man != null and client_Man.trim() != ''">
        AND client_man LIKE '%' || #{client_Man} || '%'
      </if>
      <!-- 필요하다면 inDateStart/End 조건도 추가 -->
    </where>
  </select>
  
	<!-- 검색 + 페이징 -->
	<select id="clientSearchList" parameterType="ClientSearchDto" resultType="ClientDto">
    <![CDATA[
    SELECT *
      FROM (
        SELECT rownum rn, a.*
          FROM (
            SELECT *
              FROM Client
    ]]>
    <where>
      <if test="client_Name != null and client_Name.trim() != ''">
        AND client_Name LIKE '%' || #{client_Name} || '%'
      </if>
      <if test="client_Gubun != null">
        AND client_Gubun = #{client_Gubun}
      </if>
      <if test="client_Man != null and client_Man.trim() != ''">
        AND client_Man LIKE '%' || #{client_Man} || '%'
      </if>
    </where>
    <![CDATA[
            ORDER BY client_no
          ) a
      )
    WHERE rn BETWEEN #{start} AND #{end}
    ]]>
	</select>
	
	<select id="detailClient" parameterType="int" resultType="ClientDto">
		SELECT CLIENT_NO, EMP_NO, CLIENT_NAME, CLIENT_GUBUN, CLIENT_EMAIL, CLIENT_MAN, CLIENT_ADDRESS, DEL_STATUS, MODIFY_DATE, IN_DATE 
		FROM Client 
		WHERE client_no = #{client_No}
	</select>
	
	<insert id="createClient" parameterType="ClientDto">
		INSERT INTO Client 
		(CLIENT_NO, EMP_NO, CLIENT_NAME
	   , CLIENT_GUBUN, CLIENT_EMAIL, CLIENT_MAN
	   , CLIENT_ADDRESS, IN_DATE) 
		VALUE 
	    (CLIENT_SEQ_GEN, #{client_No}, #{client_Name}, #{Client_Gubun}, #{Client_Email}, #{Client_Man}, #{Client_Address}, sysout)
	</insert>
</mapper>